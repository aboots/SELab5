به نام خدا

# آزمایش پنجم آزمایشگاه مهندسی نرم‌افزار (BDD) 
## مقدمات آزمایش
لینک گیت‌هاب پروژه: https://github.com/aboots/SELab5

در این آزمایش به کمک روش BDD سعی می‌کنیم تا یک مسئله‌ی ساده را در جاوا شبیه‌سازی کنیم و به کمک BDD آن را حل کنیم. همچنین سعی می‌کنیم تا تفاوت‌های آن با TDD را بفهمیم و با ابزار‌های موجود در جاوا آشنا شویم. این آزمایش در ide  intellij انجام شده است. ابتدا همانند آموزشی که در اختیارمان قرار گرفته عمل می‌کنیم. سپس خودمان برای یک مسئله‌ی داده شد سناریو‌ها را در دو حالت نرمال و outline طراحی می‌کنیم.

## شرح آزمایش

### ساخت پروژه و نیاز‌مندی‌ها

نخست یک پروژه‌ی جدید maven می‌سازیم.

![1](https://github.com/aboots/SELab5/assets/59336942/348ff50a-a0d1-47bc-b534-c93fd7201d9d)

همانطور که می‌بینید، پروژه با موفقیت ساخته شد. dependencyهای cucumber و junit مورد نیاز را اضافه کردیم و همانطور که می‌بینید build ما با موفقیت پس از آن انجام شد.

![2](https://github.com/aboots/SELab5/assets/59336942/0656cf7d-d6e0-45ea-889c-0e09fc2d157e)

حال گزینه‌های Import Changes و Enable Auto-Import از پیغام گوشه سمت راست پایین صفحه جهت Maven projects need to be imported میژنیم.
حال یک پکیج جدید به نام resources در پکیج test ایجاد می‌کنیم و راست کلیک بر روی آن می‌کنیم و آن را به عنوان Mark Directory as Test Resource Root انتخاب می‌کنیم. در نتیجه ملزومات راه‌اندازی شدند.

![3](https://github.com/aboots/SELab5/assets/59336942/a9b121f2-2ba2-47a5-9545-e809722a132e)

### درست کردن محاسبه‌گر جمع


حال پکیج calculator و دایرکتوری features را در جا‌های گفته شده قرار می‌دهیم. ساختار پروژه به شکل زیر در می‌آید.

![4](https://github.com/aboots/SELab5/assets/59336942/1e09edee-7824-44a2-9b1a-294b6a7d1aab)

حال سناریو‌ی اول برای add را طبق آموزش می‌نویسیم. برای حل مشکل زرد شدن، به انتهای هر یک از خطوط Given، When و Then رفته و کلید Alt+Enter را می‌زنیم تا یک فایل جهت تعیین مراحل و stepهای اجرای سناریو ایجاد شود. 

![5](https://github.com/aboots/SELab5/assets/59336942/867cc242-1113-4545-8761-534ec8ba0a75)
![6](https://github.com/aboots/SELab5/assets/59336942/8c3acc2b-4c59-472d-a79c-834159135f03)

متدهای بدون بدنه به صورت زیر در فایل MyStepdefs ایجاد می‌شوند. 

![7](https://github.com/aboots/SELab5/assets/59336942/84a3a9f8-9f2c-4419-bdb0-74edcbb72204)

حال درون آن‌ها را پر می‌کنیم همانند آموزش تا تست‌ها تکمیل شوند.

![8](https://github.com/aboots/SELab5/assets/59336942/01b8a5ba-f352-47b4-ac85-704ab3cb49c7)

با ذخیره این فایل، برخی فایل‌های پروژه به error compile برمی‌خورند؛ زیرا Calculator هنوز تعریف نشده است. این کلاس باید پس از ایجاد دایرکتوری calculator، در مسیر زیر ساخته شود: src->main->java->calculator

![9](https://github.com/aboots/SELab5/assets/59336942/26626b31-c0fc-4f0a-a47e-5020d3d2be4f)

با زدن گزینه Maven test  می‌بینیم که به ERROR برمی‌خوریم

![10](https://github.com/aboots/SELab5/assets/59336942/ec5203d8-6b12-4ee5-bad3-aa96397578e5)

برای رفع این خطا لازم است نسخه بالاتر از Maven را در فایل pom.xml معرفی کنیم. بنابراین خطوط زیر را پس از پایان dependencies به این فایل اضافه می‌کنیم. مجدداً Maven test را می‌زنیم تا این بار SUCCESS شود.

![11](https://github.com/aboots/SELab5/assets/59336942/f349ca73-26a0-4ecf-b259-b4499794a7bd)

بر روی فایل calculator.feature کلیک راست کرده و گزینه Run را انتخاب می‌کنیم تا سناریوی این feature اجرا شود. همانطور که در زیر می‌بینید سناریو با موفقیت اجرا شد.

![12](https://github.com/aboots/SELab5/assets/59336942/85610626-c326-4945-9481-20dcd731a8ad)

برای مشاهده جزئیات اجرا از طریق JUnit به این صورت عمل می‌کنیم که یک کلاس جدید به نام RunnerTest.java در مسیر test->java->calculator (کنار فایل MyStepdefs) ایجاد می‌نماییم و بدنه آن را مانند آموزش پر می‌کنیم. با زدن فلش سبزرنگ کنار نام کلاس، این فایل اجرا می‌شود ولی این بار به یک خطای جدید برمی‌خورد. چون path مربوطه را پیدا نمی‌کند.

![13](https://github.com/aboots/SELab5/assets/59336942/33fc788a-38f9-403e-b1bf-c6d9f14aa17b)

با اجرای مجدد RunnerTest و مشخص کردن path خروجی به صورت زیر نمایش داده می‌شود و درست جزئیات نشان داده می‌شود.

![14](https://github.com/aboots/SELab5/assets/59336942/5077c441-9413-467b-9d3c-4c6f6717a82c)

حال برای تست، خروجی را به جای ۳ تبدیل به ۳۰۰۰ می‌کنیم و دوباره ران می‌کنیم. همانطور که می‌بینید نتیجه‌ی تست رانگ می‌شود.

![15](https://github.com/aboots/SELab5/assets/59336942/e3af6f7d-0c23-4392-9e77-448a592bdbe2)

حال نوبت به تعریف نوع دیگری از سناریو به نام scenario outline است که آن را مثل دستورکار تعریف می‌کنیم و اجرا می‌کنیم. همانطور که می‌بینید یکی از تست‌ها به مشکل undefined بر‌می‌خورد که همانطور که در زیر مشخص است تست دوم scenario outline به مشکل می‌خورد.

![16](https://github.com/aboots/SELab5/assets/59336942/741c3128-68bb-490a-8296-6766f89ef4f1)

این مشکل به دلیل ragexهای تولید شده می‌باشد که تنها توانایی پذیرش عدد‌های مثبت را دارند و توانایی پذیرش عدد‌های منفی را ندارند و در آن تست کیس از آن‌جا که عدد اول منفی است تست ما به مشکل می‌خورد. برای حل آن ragex را در given و then عوض کردیم که توانایی پذیرش اعداد منفی را داشته باشد که در زیر آن را می‌بینید. 

![17](https://github.com/aboots/SELab5/assets/59336942/7cca04f2-37e0-47a3-bfbd-241ce9858608)

حال تست‌ها را دوباره حل می‌کنیم و همانطور که می‌بینید به درستی حل می‌شود و تمام تست‌ها پاس می‌شوند. 

![18](https://github.com/aboots/SELab5/assets/59336942/b3529ff5-385a-4b0b-b2e7-9b0ef9a6c794)
